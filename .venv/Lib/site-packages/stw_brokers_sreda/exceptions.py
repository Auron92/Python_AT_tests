import grpc
from stw_py_api_runtime.sdk.exceptions import (
    BadArgumentsError, CancelledError, CmdError, RpcDeadlineError, RpcError,
    UnImplimentedError,
)


def raise_rpc_error(grps_error: grpc.RpcError):  # noqa: WPS238
    """Типы исключений."""
    message = str(grps_error)
    match grps_error.code():
        case grpc.StatusCode.CANCELLED:
            raise CancelledError('Отправка команды была отменена или закрыт канал', message)
        case grpc.StatusCode.DEADLINE_EXCEEDED:
            raise RpcDeadlineError(
                'Время ожидания ответа истекло до того, как операция смогла завершиться.', message,
            )
        case grpc.StatusCode.UNIMPLEMENTED:
            raise UnImplimentedError('Команда не поддерживается, либо не реализована на устройстве.', message)
        case grpc.StatusCode.INVALID_ARGUMENT:
            raise BadArgumentsError('Передан невалидный аргумент', message)
        case grpc.StatusCode.ABORTED:
            raise CmdError('Команда не отправлена', message)
        case _:
            raise RpcError(message)


class ModuleError(Exception):
    """Ошибка идентификации модуля."""
