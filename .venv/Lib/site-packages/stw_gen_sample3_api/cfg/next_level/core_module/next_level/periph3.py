from dataclasses import dataclass

from stw_py_api_runtime.gen_classes.gen_device import GenCfg
from stw_py_api_runtime.sdk.brokers.broker_api import BrokerAPI
from stw_py_api_runtime.gen_classes.telemetry.parse import Message as _Message
from stw_gen_sample3_api.basic_types import *


@dataclass
class VoltageThresholdsCfg(_Message):
    """Пороги напряжения для отслеживания перехода между состояниями (Under<=>Normal<=>Over)"""
    # Пороги напряжения по всем каналам
    from stw_gen_sample3_api.types.core.periph3.channels_voltage_thresholds_type import ChannelsVoltageThresholds
    value: ChannelsVoltageThresholds


@dataclass
class OverPowerThresholdCfg(_Message):
    """Верхний порог мощности"""
    # Верхний порог мощности
    from stw_gen_sample3_api.types.core.periph3.over_power_type import OverPower
    value: OverPower


class Cfg(GenCfg):
    def __init__(self, device, broker: BrokerAPI):

        self.voltageThresholds = broker.tm_catcher_class[VoltageThresholdsCfg](device, broker, 'core.periph3.', VoltageThresholdsCfg)
        self.overPowerThreshold = broker.tm_catcher_class[OverPowerThresholdCfg](device, broker, 'core.periph3.', OverPowerThresholdCfg)
