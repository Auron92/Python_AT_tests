from dataclasses import dataclass

from stw_py_api_runtime.gen_classes.gen_device import GenTm
from stw_py_api_runtime.sdk.brokers.broker_api import BrokerAPI, TmCatcherAPI
from stw_py_api_runtime.sdk.brokers.message import DeviceAddress
from stw_py_api_runtime.gen_classes.telemetry.parse import Message as _Message
from stw_gen_sample3_api.basic_types import *


@dataclass
class NowTm(_Message):
    """Текущее время."""

    # Наличие синхронизации
    isSync: bool_type
    # Системное время (GPS)
    from stw_gen_sample3_api.types.core.time.gps_type import Gps
    system: Gps
    # Непрерывное время
    from stw_gen_sample3_api.types.core.time.up_type import Up
    steady: Up


@dataclass
class DateTimeTm(_Message):
    """Текущие дата и время."""

    # Дата/время
    from stw_gen_sample3_api.types.core.time.date_time_type import DateTime
    system: DateTime


class Tm(GenTm):
    def __init__(self, device_address: DeviceAddress, broker: BrokerAPI, pygen_device):
        """Конструктор модуля телеметрии."""

        self.now = broker.tm_catcher_class[NowTm](
            device_address=device_address, broker=broker, pygen_device=pygen_device,msg_type=NowTm, name='core.time.now',
            msg_id=3222577513, req_id=571146076, rep_id=1426968522,
        )
        self.dateTime = broker.tm_catcher_class[DateTimeTm](
            device_address=device_address, broker=broker, pygen_device=pygen_device,msg_type=DateTimeTm, name='core.time.dateTime',
            msg_id=2404992450, req_id=3040834669, rep_id=3258467579,
        )
