name: shared_types
info: СД
modules:
- name: core.dtc
  info: Интерфейс по работе с ошибками
  cmds:
  - info: Снятие активного события
    msg_id: 2016867397
    req_id: 0
    rep_id: 3080081033
    params:
    - name: msgid
      info: Идентификатор события для снятия
      type: uint32_t
    rep:
    - repstub.Error
    - repstub.Ok
    name: clearActiveEvent
    type_id: 3923892457
  - info: Записать события в файл
    msg_id: 1816925282
    req_id: 0
    rep_id: 3969600687
    params:
    - name: severity
      info: Тип событий
      max: 3
      type: core.dtc.Severity
    rep:
    - repstub.Error
    - repstub.Ok
    name: flush
    type_id: 1148019036
  tms:
  - info: Вектор активных событий
    msg_id: 2448110288
    req_id: 846030069
    rep_id: 1164596323
    params:
    - name: value
      info: Вектор активных событий (ошибок или предупреждений)
      type: core.dtc.ActiveEvents
    name: activeEvents
    type_id: 2884110416
  types:
  - kind: struct
    info: Активное событие (ошибка или предупреждение)
    name: core.dtc.ActiveEvent
    fields:
    - name: msgid
      info: Идентификатор события
      type: uint32_t
    - name: ts
      info: Время первого возникновения
      type: core.time.Up
      unit: нс
    - name: count
      info: Количество возникших событий
      type: uint32_t
  - kind: vector
    info: Вектор активных событий (ошибок или предупреждений)
    name: core.dtc.ActiveEvents
    count: 12
    base: core.dtc.ActiveEvent
  - kind: enum
    info: Тип событий
    min: 0
    max: 3
    name: core.dtc.Severity
    values:
    - name: All
      value: 0
      info: Все типы
    - name: Info
      value: 1
      info: Информационные
    - name: Warning
      value: 2
      info: Предупреждения
    - name: Error
      value: 3
      info: Ошибки
    base: uint8_t
  import:
  - core.time
  - repstub
- name: core.heartbeat
  info: Diagnostic Trouble Code (DTC)
  tms:
  - info: Функциональный статус о текущем состоянии прибора
    msg_id: 3029201892
    req_id: 2783637266
    rep_id: 3538804612
    params:
    - name: state
      info: Состояние прибора
      max: 1
      type: core.heartbeat.State
    - name: warnCnt
      info: Накопленное количество предупреждений
      type: uint32_t
    - name: errCnt
      info: Накопленное количество ошибок
      type: uint32_t
    name: status
    type_id: 3361834620
  types:
  - kind: enum
    info: Состояние прибора
    min: 0
    max: 1
    name: core.heartbeat.State
    values:
    - name: Ok
      value: 0
      info: Может выполнять целевую функцию
    - name: Fail
      value: 1
      info: Не может выполнять целевую функцию
    base: uint8_t
  import:
  - repstub
- name: core.time
  info: Информация о времени в приборе
  remark: Модуль, содержащий информацию о времени в борту. Есть два типа времени -
    системное(system - Gps) и непрерывное(steady - Up)
  includes:
  - stw/time/Time.h
  - stw/time/Units.h
  types:
  - kind: synonym
    info: Cекунды
    name: core.time.s8u
    base: uint8_t
  - kind: synonym
    info: Cекунды
    name: core.time.s16u
    base: uint16_t
  - kind: synonym
    info: Cекунды
    name: core.time.s32u
    base: uint32_t
  - kind: synonym
    info: Cекунды
    name: core.time.s64u
    base: uint64_t
  - kind: synonym
    info: Cекунды
    name: core.time.s8i
    base: int8_t
  - kind: synonym
    info: Cекунды
    name: core.time.s16i
    base: int16_t
  - kind: synonym
    info: Cекунды
    name: core.time.s32i
    base: int32_t
  - kind: synonym
    info: Cекунды
    name: core.time.s64i
    base: int64_t
  - kind: synonym
    info: Миллисекунды
    name: core.time.ms8u
    base: uint8_t
  - kind: synonym
    info: Миллисекунды
    name: core.time.ms16u
    base: uint16_t
  - kind: synonym
    info: Миллисекунды
    name: core.time.ms32u
    base: uint32_t
  - kind: synonym
    info: Миллисекунды
    name: core.time.ms64u
    base: uint64_t
  - kind: synonym
    info: Миллисекунды
    name: core.time.ms8i
    base: int8_t
  - kind: synonym
    info: Миллисекунды
    name: core.time.ms16i
    base: int16_t
  - kind: synonym
    info: Миллисекунды
    name: core.time.ms32i
    base: int32_t
  - kind: synonym
    info: Миллисекунды
    name: core.time.ms64i
    base: int64_t
  - kind: synonym
    info: Микросекунды
    name: core.time.us8u
    base: uint8_t
  - kind: synonym
    info: Микросекунды
    name: core.time.us16u
    base: uint16_t
  - kind: synonym
    info: Микросекунды
    name: core.time.us32u
    base: uint32_t
  - kind: synonym
    info: Микросекунды
    name: core.time.us64u
    base: uint64_t
  - kind: synonym
    info: Микросекунды
    name: core.time.us8i
    base: int8_t
  - kind: synonym
    info: Микросекунды
    name: core.time.us16i
    base: int16_t
  - kind: synonym
    info: Микросекунды
    name: core.time.us32i
    base: int32_t
  - kind: synonym
    info: Микросекунды
    name: core.time.us64i
    base: int64_t
  - kind: synonym
    info: Наносекунды
    name: core.time.ns8u
    base: uint8_t
  - kind: synonym
    info: Наносекунды
    name: core.time.ns16u
    base: uint16_t
  - kind: synonym
    info: Наносекунды
    name: core.time.ns32u
    base: uint32_t
  - kind: synonym
    info: Наносекунды
    name: core.time.ns64u
    base: uint64_t
  - kind: synonym
    info: Наносекунды
    name: core.time.ns8i
    base: int8_t
  - kind: synonym
    info: Наносекунды
    name: core.time.ns16i
    base: int16_t
  - kind: synonym
    info: Наносекунды
    name: core.time.ns32i
    base: int32_t
  - kind: synonym
    info: Наносекунды
    name: core.time.ns64i
    base: int64_t
  - kind: synonym
    info: Время по шкале GPS
    name: core.time.Gps
    base: int64_t
  - kind: synonym
    info: Время от старта прибора
    name: core.time.Up
    base: int64_t
  - kind: synonym
    info: Время по шкале Ut1
    name: core.time.Ut1
    base: int64_t
  - kind: struct
    info: Время
    name: core.time.Date
    fields:
    - name: year
      info: Год
      type: uint16_t
    - name: month
      info: месяц
      type: uint8_t
    - name: day
      info: день месяца
      type: uint8_t
  - kind: struct
    info: Время
    name: core.time.DateTime
    fields:
    - name: year
      info: Год
      type: uint16_t
    - name: month
      info: месяц
      type: uint8_t
    - name: day
      info: день месяца
      type: uint8_t
    - name: hour
      info: час
      type: uint8_t
    - name: minute
      info: минута
      type: uint8_t
    - name: second
      info: секунда
      type: uint8_t
  import:
  - repstub
- name: core.fs
  info: Файловый сервис
  cmds:
  - name: getData
    info: Получить часть файла
    msg_id: 801026859
    params:
    - name: id
      type: core.fs.FileId
    - name: offset
      type: uint32_t
    - name: size
      type: uint32_t
    rep_id: 535790568
    rep:
    - repstub.Error
    - core.fs.FixedData
    type_id: 2546850355
  - name: sendData
    info: Отправить часть файла
    msg_id: 1710034971
    params:
    - name: id
      type: core.fs.FileId
    - name: offset
      type: uint32_t
    - name: size
      type: uint32_t
    - name: arr
      type: core.fs.FixedDataArr
    rep_id: 862273129
    rep:
    - repstub.Error
    - repstub.Ok
    type_id: 1718564318
  - name: getFileInfo
    info: Запросить информацию о файле
    msg_id: 1640507228
    params:
    - name: id
      type: core.fs.FileId
    rep_id: 4212963590
    rep:
    - repstub.Error
    - core.fs.FileInfo
    type_id: 3762662567
  - name: getFilesList
    info: Запросить список id файлов
    msg_id: 3948368546
    rep_id: 875269826
    req_id: 0
    rep:
    - repstub.Error
    - core.fs.FilesList
    type_id: 1174607116
  - name: createFile
    info: Создать файл
    msg_id: 1147027662
    params:
    - name: id
      type: core.fs.FileId
    - name: name
      type: core.fs.FileName
    - name: size
      type: uint32_t
    rep_id: 3453138007
    rep:
    - repstub.Error
    - repstub.Ok
    type_id: 3406287718
  - name: finish
    info: Закончить запись в файл
    msg_id: 3016600587
    remark: Выполняется расчет CRC и передается ожидаемая CRC
    params:
    - name: id
      type: core.fs.FileId
    - name: crc
      type: core.fs.FileCrc
    rep_id: 1426865601
    rep:
    - repstub.Error
    - repstub.Ok
    type_id: 4001961867
  types:
  - kind: array
    info: Имя файла
    name: core.fs.FileName
    count: 32
    base: uint8_t
  - kind: synonym
    info: Идентификатор файла
    name: core.fs.FileId
    base: uint16_t
  - kind: synonym
    info: Контрольная сумма содержимого файла
    name: core.fs.FileCrc
    base: uint32_t
  - kind: synonym
    info: Время создания файла
    name: core.fs.FileTime
    base: core.time.Gps
  - kind: struct
    info: Информация о файле
    name: core.fs.FileInfo
    fields:
    - name: id
      type: core.fs.FileId
    - name: name
      type: core.fs.FileName
    - name: size
      type: uint32_t
    - name: crc
      type: core.fs.FileCrc
    - name: created
      type: core.fs.FileTime
  - kind: array
    info: Массив фиксированного размера, содержащий данные из файла
    name: core.fs.FixedDataArr
    count: 100
    base: uint8_t
  - kind: struct
    info: Часть файла
    name: core.fs.FixedData
    fields:
    - name: offset
      type: uint32_t
    - name: size
      type: uint32_t
    - name: data
      type: core.fs.FixedDataArr
  - kind: array
    info: Массив фиксированного размера, содержащий id файлов
    name: core.fs.FixedFilesIdArr
    count: 50
    base: core.fs.FileId
  - kind: struct
    info: Список id файлов
    name: core.fs.FilesList
    fields:
    - name: count
      info: Количество файлов
      type: uint16_t
    - name: filesId
      info: Id файлов
      type: core.fs.FixedFilesIdArr
  - kind: struct
    info: Информация о файловой системе
    name: core.fs.FsInfo
    fields:
    - name: mounted
      info: Состояние подключения
      type: bool
    - name: capacity
      info: Емкость памяти
      type: uint32_t
      unit: байт
    - name: usedSpace
      info: Занято памяти
      type: uint32_t
      unit: байт
    - name: freeSpace
      info: Свободно памяти
      type: uint32_t
      unit: байт
  import:
  - core.time
  - repstub

- name: repstub
  info: Ошибки обмена
  types:
  - kind: enum
    min: 0
    max: 0
    name: repstub.Ok
    values:
    - name: Ok
      value: 0
      info: Ok
    base: uint8_t
  - kind: enum
    min: 0
    max: 23
    name: repstub.Error
    values:
    - name: CmdParamTooMany
      value: 0
      info: много параметров для команды
    - name: CmdNotEnoughData
      value: 1
      info: недостаточно параметров для команды
    - name: CmdBadArg
      value: 2
      info: некорректные параметры команды
    - name: TmUnknown
      value: 3
      info: неизвестное тм-сообщение
    - name: NotImplemented
      value: 4
      info: не реализовано
    - name: NotEnoughMemory
      value: 5
      info: недостаточно памяти
    - name: NonEmptyOnShort
      value: 6
      info: некорректная склейка бубен-сообщения
    - name: BadFirst
      value: 7
      info: некорректная первая часть длинного сообщения
    - name: EmptyOnFirst
      value: 8
      info: присутствует начало сообщения на фоне нового
    - name: MsgTooBig
      value: 9
      info: слишкомдлинное сообщение
    - name: MiddleOnEmpty
      value: 10
      info: присутствует середина сообщения на фоне нового
    - name: MiddleOnShortOrLast
      value: 11
      info: присутствует середина сообщения на фоне короткого
    - name: MiddleExceedsSize
      value: 12
      info: недостаточно памяти для склейки сообщения
    - name: LastOnEmpty
      value: 13
      info: пришел конец а сообщения нет
    - name: LastOnShort
      value: 14
      info: пришел конец а там короткое
    - name: BadLastSize
      value: 15
      info: некорректный размер последнего куска
    - name: BadCrc
      value: 16
      info: некорректное crc
    - name: BadSizeInBuf
      value: 17
      info: некорректный размер в буфере
    - name: BadSizeInBuf2
      value: 18
      info: некорректный размер в буфере2
    - name: ShortOrFirstOnMiddleOrLast
      value: 19
      info: присутствует начало сообщения на фоне нового
    - name: MiddleOrLastOnEmpty
      value: 20
      info: пришла середина или конец а начала нет
    - name: MiddleOnReady
      value: 21
      info: пригла середина на фоне готового сообщения
    - name: PreviousItemIsCorrupted
      value: 22
      info: предыдущее сообщение испорчено
    - name: CmdBadContext
      value: 23
      info: неверный контекст исполнения команды
    base: uint8_t