"""Методы для работы с мета-информаией прибора."""
import hashlib
from typing import Callable, List, Tuple

from stw_py_api_runtime.gen_classes.pygen_device_class import PyGenDevice


def _find_cmds(device: PyGenDevice) -> Tuple[Callable, Callable]:
    try:  # noqa: WPS229
        meta_cmd = device.core.pkg.getMeta
        chunk_cmd = device.core.pkg.getChunk
    except AttributeError:
        raise ValueError('Device have no getMeta or getChunk')
    return meta_cmd, chunk_cmd


def _zpaq_hash(file_data: bytes) -> List[int]:
    hash_length = 12
    sha3_maker = hashlib.sha3_512()
    sha3_maker.update(file_data)
    return list(sha3_maker.digest())[:hash_length]
