# Генерация кода
yaml файл должен содержать следующую структуру:

```yaml
name: {имя прибора, напр. mtcu}
info: {расшифровка, напр. ССКМ}
modules:
- name: {полное имя модуля, напр. core.can}
  info: {описание модуля}
  cmds:  # команды
  - name: {command name}
    info: {описание команды}
    msg_id: {???}
    params:
    - name: {имя параметра}
      type: {тип параметра}
  tms:  # телеметрия + типы ответв на команды
  - name: {название параметра}
    info: {описание параметра}
    msg_id: {???}
    params:
    - name: {имя опции}
      info: {описание опции}
      type: {тип данных опции}
  types:  # типы данных ?чем отличается от tms??
  - kind: {struct | enum | array | synonym | bits}
    info: {описание типа}
    name: {полное имя типа}
    # kind-specific fields
    # ....
  - import:
  - {полное имя импортируемого типа}
```

## Kind specific поля
### struct
```yaml
fields:
- name: {имя поля}
  type: {тип данных, хранящихся в поле}
  
```
### enum
```yaml
min: {мин. значение enum, uint}
max: {макс. значение enum, uint}
values:
- name: {имя enum варианта}
  value: {значение enum варианта}
  info: {описание значения текстом}
base: {тип значений enum-a: }
```
Поддерживаемые типы значений enum-a (int-like):
```text
'uint8_t', 'uint16_t', 'uint32_t', 'uint64_t',
    'int8_t',  'int16_t',  'int32_t',  'int64_t',
    'ui8',     'ui16',     'ui32',     'ui64',
    'u8',      'u16',      'u32',      'u64',
    'i8',      'i16',      'i32',      'i64',
    '__u1',    '__u2',     '__u3',     '__u4',
    '__u5',    '__u6',     '__u7',     '__u8',
    '__u9',    '__u10',    '__u11',    '__u12',
    '__u13',   '__u14',    '__u15',    '__u16',
    '__u17',   '__u18',    '__u19',    '__u20',
    '__u21',   '__u22',    '__u23',    '__u24',
    '__u25',   '__u26',    '__u27',    '__u28',
    '__u29',   '__u30',    '__u31',    '__u32',
```
### array
```yaml
count: {количество элементов в массиве}
base: {тип элемента массива}
```
### synonym
```yaml
base: {тип, которому эквивалентен описываемый}
```
### bits
base: {int-like тип}
fields:
- name:
  min[?]: {мин. значение поля}
  max[?]: {макс. значения поля}
  size: {размер поля в битах}


# Как yaml файл транслируется в Python код
Код после генерации содержит в себе:
- команды
- телеметрию
- типы

## Команды будут доступны по прямому имени.
Например, если в файле был модуль `core.can` и у него была команда `setActiveCan`, то
выдать её можно так: `device.core.can.setActiveCan`.

## Телеметрия
Запрашивать телеметрию можно так:
- `await device.get_tm_msg('Tm.Name')`, где 'Tm.Name' - 
строковое имя телемтрии
- `await device.get_tm_msg(TMtype)`, где TMtype - это телеметрический тип из:
`gen_device.tm`

При этом будет возвращен объект класса `gen_device.tm.TMtype`

## Типы
Типы будут доступны в `gen_device.types` модуле

### Карта разработки
Арифметические типы:
uint8_t, int8_t, uint16_t, int16_t, uint32_t, int32_t, uint64_t, 
int64_t, float, double
Бытовые типы: '__u1', '__u2' ... '__u64'

Команды:
- [x] генерация команд
- [x] аргументы у команд

| тип            | готовность |
|----------------|------------|
| арифметрческие | +          |
| битовые        | n/a        |
| bytes          | n/a        |

- [ ] Телеметрические типы

| тип            | готовность |
|----------------|------------|
| арифметрческие | -          |
| битовые        | -          |
| bytes          | -          |