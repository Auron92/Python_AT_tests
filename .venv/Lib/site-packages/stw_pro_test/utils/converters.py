"""Различные конвертеры одного в другое."""
from pathlib import Path

from PIL import Image


def any2int(value: str) -> int:
    """Convert hex or dec in dec."""
    if isinstance(value, int):
        return value
    return int(value, 16 if '0x' in value else 10)


def any2bool(str_value: str | bool) -> bool:
    """
    Приходится парсить bool из cli, поскольку туда его можно только строкой передать.

    action="store_true" doesn't work properly. You can't pass bool args
    :param str_value: 'True' or 'False'
    :return: parsed bool
    """
    if isinstance(str_value, bool):
        return str_value
    match str_value.lower():
        case 'true':
            return True
        case 'false':
            return False
        case _:
            raise ValueError('Неправильный тип для bool')


def convert_raw_image(
        bin_path: str | Path,
        output: str | Path,
        width: int,
        height: int,
) -> None:
    """
    Read bytes and save as image.

    :param bin_path: input file path
    :param output: output file path
    :param width: from init image
    :param height: from init image
    """
    with open(bin_path, 'rb') as f:
        bin_image = f.read()
    image = Image.frombytes('L', (width, height), bin_image, 'raw')
    image.save(output)
